#layout {
  display: flex;
  height: 100vh;
  width: 100vw; /* fill viewport width */
}

/* ensure no default page margins cause tiny gaps */
html, body {
  height: 100%;
  margin: 0;
}


#leftPanel {
  flex: 0 0 40%; /* fixed half layout but keep min-width */
  max-width: 40%;
  min-width: 320px;
  height: 100vh;
  overflow-y: auto; /* singola scrollbar */
  display: flex;
  flex-direction: column;
  border-right: 1px solid #eee;
  background: #fff;
  font-family: 'Poppins', sans-serif;
}

#map { height: 100vh; flex: 1 1 50%; min-width: 0; display: grid; }


/* In modalit√† DETTAGLIO: pannello sinistro 60%, mappa 40% */
.detail-mode #leftPanel { width: 60%; max-width: 60%; }
.detail-mode #map { width: 40%; }

.hidden { display: none !important; }

/* List view */
#listView {
  overflow-y: auto;
  padding: 12px;
  height: 100%;
}
.list-item {
  border: 1px solid #cfcfcf;
  border-radius: 10px;
  padding: 14px; /* was 10px: slightly taller for breathing room */
  margin-bottom: 12px; /* a touch more separation between items */
  cursor: pointer;
  /* transition: box-shadow .2s ease, transform .05s ease; */
}
.list-item:hover { box-shadow: 0 2px 8px rgb(0, 0, 0); }
.list-item:active { transform: scale(0.995); }
.li-title { font-weight: 600; padding-bottom: 15px; font-size: 25px; }
.li-meta { color: #555; font-size: 17px; line-height: 1.4; }

/* Inline small red heart shown in list items for liked restaurants */
.li-liked { color: #e3002b; margin-right: 8px; margin-bottom: 10px; font-size: 20px; vertical-align: middle; pointer-events: none; }

/* Detail view */
#detailView { overflow: visible; display: flex; flex-direction: column; height: auto; }
.dp-header { display:flex; align-items:center; justify-content: space-between; padding: 10px 12px; border-bottom: 1px solid #eee; }
.dp-title-wrap { display:flex; align-items:center; gap:10px; }
.dp-header-actions { display:flex; align-items:center; gap:8px; }
.back-btn { background:#f3f3f3; border:1px solid #ddd; padding:6px 10px; border-radius:8px; cursor:pointer }
.dp-photo-area { position: relative; flex: 0 0 440px; display:flex; align-items:center; justify-content:center; background:#0d0d0d; padding:0; overflow:hidden; }
#dpCurrentPhoto { width:100%; height:100%; object-fit:cover; transform:scale(1.04); }
.hero-overlay { position:absolute; inset:0; display:flex; flex-direction:column; justify-content:flex-end; padding:26px 24px 20px; background:linear-gradient(180deg,rgba(0,0,0,0.02) 0%,rgba(0,0,0,0.16) 52%,rgba(0,0,0,0.36) 100%); pointer-events:none; }
.hero-top-bar { position:absolute; top:10px; left:10px; right:10px; display:flex; justify-content:space-between; gap:10px; pointer-events:auto; z-index:6; }
.hero-title { margin:0; font-size:30px; line-height:1.18; color:#fff; font-weight:600; text-shadow:0 2px 10px rgba(0,0,0,0.65); word-wrap:break-word; overflow:visible; z-index:5; }
.hero-btn { background:#ffffff; border:2px solid #111; padding:8px 14px; border-radius:14px; font-weight:600; cursor:pointer; color:#111; box-shadow:0 3px 0 #111, 0 6px 14px -4px rgba(0,0,0,0.35); transition:transform .15s, box-shadow .25s, background .25s; z-index:7; position:relative; }
.hero-btn.like-btn { font-size:30px; line-height:1; display:flex; align-items:center; justify-content:center; width:58px; height:54px; padding:0; background:#fff; border:2px solid #111; box-shadow:0 3px 0 #111, 0 6px 14px -4px rgba(0,0,0,0.35); font-family:'Poppins',sans-serif; }
.hero-btn.like-btn span { display:block; }
.hero-btn.like-btn:not(.liked) { color:#111; }
.hero-btn.like-btn.liked { color:#e3002b; }
.hero-btn:hover { transform:translateY(-2px); }
.hero-btn:active { transform:translateY(0); box-shadow:0 2px 0 #111; }

/* Cards */
.card { background:#fff; border:1px solid #ececec; border-radius:14px; padding:16px 18px 18px; margin:18px 12px 0; box-shadow:0 4px 18px -6px rgba(0,0,0,0.06); }
.card-title { margin:0 0 12px; font-size:18px; letter-spacing:.6px; font-weight:700; font-size: 20px; text-transform:uppercase; color:#333; font-family:'Poppins',sans-serif; }
.chips-section { margin:14px 12px 0; padding:4px 4px 0; }
.facts-grid { margin-top:4px; }

/* Reviews section spacing */
#dpReviewsContainer { margin:22px 12px 40px; }
.reviews-header { background:transparent; padding:0 4px 8px; border-bottom:1px solid #eee; }
.reviews-list { margin-top:14px !important; }
.review { background:#fff; border:1px solid #eee; border-radius:10px; padding:10px 12px; line-height:1.4; box-shadow:0 3px 10px -4px rgba(0,0,0,0.06); }
.review + .review { margin-top:10px; }

/* Add review button */
.add-review-btn {
  margin-left: auto;
  background: #111;
  color: #fff;
  border: 1px solid #111;
  padding: 8px 12px;
  border-radius: 10px;
  cursor: pointer;
  font-size: 18px;
  line-height: 1;
}
.add-review-btn:hover { opacity: 0.9; }
#dpReviewsLabel { font-size: 22px; font-weight: 600; color: #111; }

/* Stato visivo disabilitato per Add Review, ma clic ancora gestito per mostrare toast */
.add-review-btn.is-disabled {
  opacity: .55;
  cursor: not-allowed;
  filter: grayscale(40%);
}

/* Chip categories (future ready) */
.chip { position:relative; }
.chip[data-cat="service"] { background:#e6f3ff; border-color:#d1e9fa; }
.chip[data-cat="diet"] { background:#e8f9ef; border-color:#c8eed8; }
.chip[data-cat="pay"] { background:#f5ecff; border-color:#e9dcff; }
.chip[data-cat="access"] { background:#eef7ff; border-color:#d7ebfa; }

@media (max-width: 900px){
  .hero-overlay { padding:34px 20px 22px; }
  .hero-title { font-size:24px; }
  .card { margin:16px 8px 0; }
  .chips-section { margin:12px 8px 0; }
  #dpReviewsContainer { margin:20px 8px 32px; }
}
#dpCurrentPhoto { max-width:100%; max-height: 100%; object-fit: contain; display:block; }

#dpDetails { padding: 12px; }

/* Detail enhanced */
.chips-row { display:flex; flex-wrap:wrap; gap:6px; margin:8px 0 12px; }
.chip { background:linear-gradient(135deg,#f7f8fa,#eceef3); border:1px solid #d9dde3; padding:6px 12px; font-size:13px; border-radius:24px; font-weight:600; color:#1e1e24; box-shadow:0 1px 2px rgba(0,0,0,0.06); }
.chip:hover { background:linear-gradient(135deg,#ffffff,#e6eaf0); }
.open-badge { display:inline-block; margin-left:6px; padding:3px 8px; font-size:11px; font-weight:600; border-radius:6px; vertical-align:middle; letter-spacing:.5px; }
.open-badge.open { background:#e0f8eb; color:#118a3a; border:1px solid #8dd8af; }
.open-badge.closed { background:#fdeaea; color:#b30000; border:1px solid #f5b5b5; }

/* Nascondi tooltip Leaflet durante la visualizzazione dei dettagli per evitare distrazioni */
.detail-mode .leaflet-tooltip { display:none !important; }
.rating-summary { font-size:14px; margin-bottom:10px; display:flex; align-items:center; gap:6px; flex-wrap:wrap; }
.rating-summary .price { opacity:0.8; }
.facts-grid { display:grid; grid-template-columns: 1fr 1fr; gap:10px 22px; margin-bottom:10px; font-size:15px; line-height:1.45; }
@media (max-width: 760px){ .facts-grid { grid-template-columns: 1fr; } }
.fact { display:flex; align-items:flex-start; gap:8px; position:relative; padding:4px 2px; border-radius:6px; }
.fact:hover { background:#f4f6f9; }
.fact .icon { width:22px; text-align:center; opacity:0.78; font-size:22px; }
.fact .fact-text { font-size: 18px; font-weight: 500; }
.hours-block { margin:16px 0; padding:12px 14px; background:#fafafa; border:1px solid #eee; border-radius:10px; }
.hours-block h4 { margin:0 0 6px; font-size:14px; letter-spacing:.5px; text-transform:uppercase; font-weight:600; }
.hours-box.today { background:#e9f8ff; border-color:#b9e6f7; box-shadow:0 0 0 2px rgba(0,153,255,0.15); }
.hours-box.today .hours-day { color:#0077b6; }
.editorial { background:#fff7ef; border:1px solid #f5d7b2; padding:12px 14px; border-radius:10px; line-height:1.4; font-size:13px; margin:12px 0; }
.editorial p { margin:0; }
.inline-stars .star { font-size:18px; }

#dpReviewsContainer { padding: 12px; }
#dpReviewsList { flex:1 1 auto; overflow:visible; }

/* Responsive: impila su mobile */
@media (max-width: 900px) {
  #layout { flex-direction: column; }
  #leftPanel { width: 100%; max-width: 100%; height: 50vh; border-right: none; border-bottom: 1px solid #eee; }
  #map { width: 100%; height: 50vh; }
}
 
    #map { position: relative; }
      #status {
        grid-area: 1 / 1;
        justify-self: center;
        align-self: start;
        margin-top: clamp(8px, 2vh, 24px);
        background: rgba(255,255,255,0.95);
        padding: 10px 16px;
        border-radius: 10px;
        font-family: 'Poppins', sans-serif;
        font-weight: 500;
        box-shadow: 0 6px 18px rgba(0,0,0,0.15);
        z-index: 999;
        text-align: center;
        max-width: 70%;
        pointer-events: none;
      }
  #dpReviewsList { flex:1 1 auto; overflow:visible; }
    /* Modal carosello */
    #photoModal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.8);
      justify-content: center;
      align-items: center;
    }

    .hours-block h4 { display:none; }
 
    #photoModalContent {
      position: relative;
      background: #222;
      border-radius: 12px;
      width: 95%;
      height: 92%;
      overflow: hidden;
      padding: 18px;
      color: rgb(255, 255, 255);
    }
 
    /* Modal grid: left foto, right dettagli + recensioni */
    .modal-grid {
      display: flex;
      gap: 18px;
      height: 100%;
    }

    .photo-wrapper {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(180deg,#000,#222); /* scuro solo dietro le foto */
      border-radius: 10px;
      padding: 8px;
    }

    #photoModalContent img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      border-radius: 8px;
      display: block;
    }
 
    /* close-inline usato dentro header-row */
    .close-inline {
      font-size: 40px;
      font-weight: 700;
      color: #111;
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 4px 6px;
      border-radius: 6px;
      line-height: 1;
      /* Remove absolute positioning */
      position: relative;
      align-self: flex-start;
      margin-left: auto;
      z-index: 2050;
    }
 
    .carousel-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      font-size: 40px;
      background: rgba(0,0,0,0.3);
      border: none;
      color: white;
      cursor: pointer;
      padding: 5px 12px;
      border-radius: 5px;
      z-index: 10;
    }
    #prevPhoto { left: 10px; }
    #nextPhoto { right: 10px; }

  /* Frecce per il carosello nel pannello dettagli (non modal) */
  #dpPrevPhoto { left: 12px; }
  #dpNextPhoto { right: 12px; }

    .header-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

  .title-wrap { display:flex; align-items:center; gap:8px; }

    .header-actions { display:flex; align-items:center; gap:8px; }

    .like-btn {
      background: transparent;
      border: 1px solid #ddd;
      padding: 6px 10px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 18px;
      color: #111;
    }

      .details {
      font-size: 15px;
      line-height: 1.4;
      color: #000000;
      /* Rimosso overflow e max-height per scroll unico del pannello sinistro */
      flex: 0 0 auto;
    }

    .reviews-container {
      background: transparent;
      padding: 0;
      border-radius: 8px;
      margin-top: 12px;
    }

    .reviews-header {
      font-weight:600;
      cursor:pointer;
      user-select:none;
      padding: 8px 0;
      color: #111;
    }

    .reviews-header { cursor: default; display:flex; align-items:center; gap:6px; flex-wrap:wrap; }
  .reviews-header .section-label { font-size: 25px; font-weight: 700; margin-right: 14px; }
    .reviews-header .rating-number { font-weight:700; font-size:16px; background:#111; color:#fff; padding:3px 8px; border-radius:6px; }
    .reviews-count { font-size: 18px; opacity:0.7; }

    .reviews-list { padding-right: 6px; margin-top: 6px; display: flex; flex-direction: column; gap: 10px; }

    /* rimosso collapsed/expanded */

    .review {
        background: #f6f6f6; /* keep the gray box style the user likes */
        padding: 14px 16px; /* more breathing room */
        border-radius: 10px;
        font-size: 18px; /* larger base text for the comment */
        color: #111;
        border: 1px solid #e6e6e6;
      }

    .rating {
        font-size: 16px;
        color: #111;
        font-weight: 700;
        background: none;
      }

    /* Enhanced review header with avatar */
    .review-header {
      display: flex;
      align-items: center;
      justify-content: space-between; /* place stars to the right */
      gap: 10px;
      margin-bottom: 6px;
    }
    .review-id { display:flex; align-items:center; gap:10px; }
    .review-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      object-fit: cover;
      border: 1px solid #ddd;
      background: #fff;
      flex: 0 0 48px;
    }
    .review-avatar.fallback {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: #666;
      background: #fafafa;
    }
    .review-header-text { display: flex; flex-direction: column; }
    .review-author { font-weight: 700; font-size: 20px; color: #111; text-decoration: none; }
    .review-author:hover { text-decoration: underline; }
    .review-time { font-size: 14px; color: #666; }

    /* Stars row */
  .review-stars { display: flex; align-items: center; gap: 4px; margin: 0; }
    .review-stars .star { font-size: 30px; line-height: 1; }
    .review-stars .star.on { color: #FFD54A; margin: 0 0 0 0; }
    .review-stars .star.off { color: #ddd; }
    .review-rating-number { font-weight: 800; color: #111; font-size: 16px; }
    .review-text { white-space: pre-wrap; }

    /* Stelle nel header recensioni */
    #stars { display:inline-block; vertical-align:middle; margin-right:8px; margin-left: 8px;}
    .star { display:inline-block; vertical-align:middle; font-size:30px; margin-right:6px; line-height:1; }

    /* Add review form */
    .add-review-form { display:flex; flex-direction:column; gap:10px; background:#fff; border:1px solid #eee; border-radius:10px; padding:12px; }
    .add-review-form .arf-row { display:flex; align-items:center; gap:10px; }
    .add-review-form label { width: 120px; font-weight:600; font-size:13px; color:#333; }
    .add-review-form input[type="text"],
    .add-review-form input[type="number"],
    .add-review-form textarea {
      flex: 1 1 auto;
      padding: 8px 10px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
    }
    .add-review-form textarea { resize: vertical; }
    .arf-stars { display:flex; gap:6px; }
    .arf-star { font-size: 22px; background: transparent; border: none; cursor: pointer; color: #ddd; line-height: 1; padding: 0 2px; }
    .arf-star.active { color: #FFD54A; }
    .arf-actions { display:flex; gap:8px; justify-content:flex-end; margin-top: 4px; }
    .btn-secondary { background:#f3f3f3; border:1px solid #ddd; padding:6px 10px; border-radius:8px; cursor:pointer; }
    .btn-primary { background:#111; color:#fff; border:1px solid #111; padding:6px 12px; border-radius:8px; cursor:pointer; }
    .btn-primary[disabled] { opacity: .6; cursor: not-allowed; }

    /* Font uniforme per dettagli e recensioni */
      /* Font uniforme per dettagli, header e recensioni */
      .modal-right, .modal-right h2, .details, .review, .reviews-header, .header-actions, .like-btn {
        font-family: 'Poppins', sans-serif;
      }

      .modal-right h2 { font-size: 22px; margin: 0; font-weight: 600; color: #111; }
      .like-btn { font-size: 18px; font-weight: 500; }

      /* Responsive: regola la posizione della 'X' su schermi piccoli per evitare sovrapposizioni */
      @media (max-width: 800px) {
        .close-inline { top: 8px; right: 10px; font-size: 36px; }
        .title-wrap { gap:6px; }
        .title-wrap .like-btn { margin-left:4px; }
      }

      /* Opening hours 7-day grid */
      .hours-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 8px;
        margin-top: 10px;
        width: 100%;
      }
      .hours-box {
        background: #fafafa;
        border: 1px solid #eee;
        border-radius: 8px;
        padding: 8px;
        text-align: center;
        color: #111;
      }
      .hours-day { font-weight: 800; margin-bottom: 6px; font-size: 18px; }
      .hours-interval { color: #333; font-size: 17px; }

      @media (max-width: 800px) {
        .hours-grid { grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)); }
      }
      @media (max-width: 480px) {
        .hours-grid { grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); }
        .hours-box { padding: 8px; font-size: 12px; }
      }


    /* Responsive: su schermi piccoli impila a colonna */
    @media (max-width: 800px) {
      .modal-grid { flex-direction: column; }
      .modal-left, .modal-right { flex-basis: auto; }
      #photoModalContent { width: 98%; height: 96%; padding: 12px; }
    }

    /* Spinner base */
    .spinner {
      width: 44px;
      height: 44px;
      border: 4px solid #cfcfcf;
      border-top-color: #8e8e8e;
      border-radius: 50%;
      animation: spin 0.9s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Spinner di sezione (pannello sinistro / mappa) a overlay centrato con blur */
    .panel-spinner {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255,255,255,0.65);
      backdrop-filter: blur(2px);
      z-index: 500;
    }
    .panel-spinner.hidden { display: none !important; }

    /* Abilita posizionamento relativo per contenitori */
    #leftPanel { position: relative; }
    #map { position: relative; }
    
    /* Toast: container fisso top-center e varianti (namespaced per evitare conflitti Bootstrap) */
    .fe-toast-container {
      position: fixed;
      top: 12px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 3000;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      pointer-events: none; /* lascia cliccare sotto */
    }
    .fe-toast {
      pointer-events: auto;
      background: #333;
      color: #fff;
      padding: 8px 14px;
      border-radius: 10px;
      box-shadow: 0 4px 18px rgba(0,0,0,0.18);
      font-family: 'Poppins', sans-serif;
      font-weight: 600;
      letter-spacing: .2px;
      border: 1px solid rgba(255,255,255,0.1);
      opacity: 0;
      transform: translateY(-6px);
      transition: opacity .18s ease, transform .18s ease;
    }
    .fe-toast.fe-toast--success { background: #2e7d32; }
    .fe-toast.fe-toast--error { background: #c62828; }
    .fe-toast.fe-toast--info { background: #1565c0; }
    .fe-toast-container .fe-toast { opacity: 1; transform: translateY(0); }
    .fe-toast.fe-toast--hide { opacity: 0; transform: translateY(-6px); }